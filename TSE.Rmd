---
title: "tse"
author: "Renuka"
date: "2023-12-30"
output: html_document
---


```{r tse, echo=FALSE, message=FALSE, warning=FALSE, error=FALSE}
library(readxl)    # To read Excel files
library(dplyr)
library(mia)
library(TreeSummarizedExperiment)

# Read count data
counts  <- read_excel("data/Abundancetable.xlsx") # Abundance table (e.g. ASV data; to assay data)
row.names(counts) <- counts$ASV
counts <- counts %>% select (-ASV)
counts <- as.matrix(counts) # Count data must be a matrix

# Read taxonomic table
tax <- as.data.frame(read_excel("data/Taxatable.xlsx"))   # Taxonomy table (to rowData)
row.names(tax) <- tax$ASV
tax <- tax %>% select (-ASV) 

# Read sample metadata
sampledata <- as.data.frame(read_excel("data/Metadata.xlsx"))   # Sample data (to colData)
row.names(sampledata) <- sampledata$Sample

# Convert data into TreeSummarizedExperiment object
twins_tse <- TreeSummarizedExperiment(assays = SimpleList(counts=counts),
                                     colData = sampledata,
                                     rowData = tax) 

# Save the data object
saveRDS(twins_tse, file="data/twins_tse.rds")
```

```{r sib, echo=FALSE, message=FALSE, warning=FALSE, error=FALSE}
library(readxl)    # To read Excel files
library(dplyr)
library(mia)
library(TreeSummarizedExperiment)

# Read count data
counts  <- read_excel("data/sibdata/abundancetable.xlsx") # Abundance table (e.g. ASV data; to assay data)
row.names(counts) <- counts$ASV
counts <- counts %>% select (-ASV)
counts <- as.matrix(counts) # Count data must be a matrix

# Read taxonomic table
tax <- as.data.frame(read_excel("data/sibdata/taxa.xlsx"))   # Taxonomy table (to rowData)
row.names(tax) <- tax$ASV
tax <- tax %>% select (-ASV) 

# Read sample metadata
sampledata <- as.data.frame(read_excel("data/sibdata/metadata.xlsx"))   # Sample data (to colData)
row.names(sampledata) <- sampledata$Sample

# Convert data into TreeSummarizedExperiment object
sibtwin <- TreeSummarizedExperiment(assays = SimpleList(counts=counts),
                                colData = sampledata,
				rowData = tax) 

# Save the data object
saveRDS(sibtwin, file="data/sibdata/sibtwin_tse.rds")
```
