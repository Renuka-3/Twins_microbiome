"0",""
"0","###core order"
"0","tse <- readRDS(""data/twins_tse.rds"")"
"0","tse <- relAbundanceCounts(tse)"
"0","tse_Order <- agglomerateByRank(tse, rank =""Order"", onRankOnly=TRUE)"
"0","top_taxa <- getTopTaxa(tse_Order,top =8, detection = 0.1/100, prevalence = 1/100, method = ""prevalence"", assay_name = ""relabundance"")"
"0","Order_renamed <- lapply(rowData(tse)$Order,"
"0","                   function(x){if (x %in% top_taxa) {x} else {""Other""}})"
"0","rowData(tse)$Order <- as.character(Order_renamed)"
"0",""
"0","merged <- mergeCols(tse, colData(tse)$Samples)"
"0","merged1 <- transformCounts(merged, abund_values = ""counts"","
"0","                              method = ""relabundance"")"
"0",""
"0","a <- plotAbundance(merged, assay_name=""relabundance"", rank = ""Order"","
"0","              #order_rank_by=""abund"", "
"0","              order_sample_by = ""Bacillales"", add_x_text = TRUE)+ labs(x = ""Samples"", y = ""Relative abundance (%)"", title = ""Core order"")"
"0","print(a)"
