"0",""
"0","###core phyla"
"0","tse <- readRDS(""data/twins_tse.rds"")"
"0","tse <- relAbundanceCounts(tse)"
"0","tse_Phyla <- agglomerateByRank(tse, rank =""Phylum"", onRankOnly=TRUE)"
"0","top_taxa <- getTopTaxa(tse_Phyla,top =4, detection = 0.8/100, prevalence = 26.9/100, method = ""prevalence"", assay_name = ""relabundance"")"
"0","Phyla_renamed <- lapply(rowData(tse)$Phylum,"
"0","                   function(x){if (x %in% top_taxa) {x} else {""Other""}})"
"0","rowData(tse)$Phylum <- as.character(Phyla_renamed)"
"0",""
"0","merged <- mergeCols(tse, colData(tse)$Samples)"
"0","merged1 <- transformCounts(merged, abund_values = ""counts"","
"0","                              method = ""relabundance"")"
"0",""
"0","a <- plotAbundance(merged, assay_name=""relabundance"", rank = ""Phylum"","
"0","              #order_rank_by=""abund"", "
"0","              order_sample_by = ""Firmicutes"", add_x_text = TRUE)+ labs(x = ""Samples"", y = ""Relative abundance (%)"", title = ""Core phyla"")"
"0","print(a)"
