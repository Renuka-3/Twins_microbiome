"0",""
"0",""
"0","###core family"
"0","tse <- readRDS(""data/twins_tse.rds"")"
"0","tse <- relAbundanceCounts(tse)"
"0","tse_Family<- agglomerateByRank(tse, rank =""Family"", onRankOnly=TRUE)"
"0","top_taxa <- getTopTaxa(tse_Family,top =8, detection = 0.8/100, prevalence = 26.9/100, method = ""prevalence"", assay_name = ""relabundance"")"
"0","Family_renamed <- lapply(rowData(tse)$Family,"
"0","                   function(x){if (x %in% top_taxa) {x} else {""Other""}})"
"0","rowData(tse)$Family <- as.character(Family_renamed)"
"0",""
"0","merged <- mergeCols(tse, colData(tse)$Samples)"
"0","merged1 <- transformCounts(merged, abund_values = ""counts"","
"0","                              method = ""relabundance"")"
"0",""
"0","a <- plotAbundance(merged, assay_name=""relabundance"", rank = ""Family"","
"0","              #order_rank_by=""abund"", "
"0","              order_sample_by = ""Staphylococcaceae"", add_x_text = TRUE)+ labs(x = ""Samples"", y = ""Relative abundance (%)"", title = ""Core family"")"
"0","print(a)"
