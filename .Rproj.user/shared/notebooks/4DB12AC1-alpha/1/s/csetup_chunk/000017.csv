"0","library(""mia"")"
"0","tse <- readRDS(""data/twins_tse.rds"")"
"0","#Alpha diversity measures"
"0","tse <- mia::estimateDiversity(tse, "
"0","                              assay_name = ""counts"","
"0","                              index = ""shannon"", "
"0","                              name = ""shannon"")"
"0","head(colData(tse)$shannon)"
"1","     T1A "
"1","     T1B "
"1","     T2A "
"1","     T2B "
"1","     T3A "
"1","     T3B "
"1","
"
"1","1.159530 "
"1","1.362083 "
"1","0.483658 "
"1","1.134799 "
"1","1.734696 "
"1","1.549655 "
"1","
"
"0","library(ggplot2)"
"0","library(patchwork)"
"0","library(ggsignif)"
"0",""
"0","df <- as.data.frame(colData(tse))"
"0","a <- ggplot(df, aes(x = Diet, y = shannon)) +    ## Shannon Diversity for Diet"
"0","geom_boxplot(outlier.shape = NA) + "
"0","  geom_jitter(width = 0.05) + "
"0","  labs(y= ""Shannon index"", x= """", title = ""A. Diet"") + theme_bw() + theme(text = element_text(size = 13), axis.text = element_text(size = 10), axis.title = element_text(size = 12)) + geom_signif(comparisons = list(c(""Mixed"", ""Vegetarian"")), map_signif_level = FALSE, na.rm = TRUE)"
"0","  "
"0","b <- ggplot(df, aes(x = Gender, y = shannon)) +    ## Shannon Diversity for Gender"
"0","geom_boxplot(outlier.shape = NA) + "
"0","  geom_jitter(width = 0.05) + "
"0","  labs(y= ""Shannon index"", x= """", title = ""B. Gender"") + theme_bw() + theme(text = element_text(size = 13), axis.text = element_text(size = 10), axis.title = element_text(size = 12)) + geom_signif(comparisons = list(c(""Male"", ""Female"")), map_signif_level = FALSE, na.rm = TRUE)"
"0",""
"0","d <- ggplot(df, aes(x = Geographical_location, y = shannon)) +    ## Shannon Diversity for location"
"0","geom_boxplot(outlier.shape = NA) + "
"0","  geom_jitter(width = 0.05) + "
"0","  labs(y= ""Shannon index"", x= """", title = ""C. Geographical location"") + theme_bw() + theme(text = element_text(size = 13), axis.text = element_text(size = 10), axis.title = element_text(size = 12)) + geom_signif(comparisons = list(c(""Ahmednagar"", ""Pune""), c(""Pune"",""Nashik""), c(""Nashik"", ""Ahmednagar"")), map_signif_level = FALSE, na.rm = TRUE)"
"0",""
"0","## Multiple pairwise comparison for all co-factors"
"0","m <- c()"
"0","l <- df"
"0","m[[""Diet""]] <- kruskal.test(data = l, shannon ~ factor(Diet))$p.value"
"0","m[[""Geographical_location""]] <- kruskal.test(data = l, shannon ~ factor(Geographical_location))$p.value"
"0","m[[""Gender""]] <- kruskal.test(data = l, shannon ~ factor(Gender))$p.value"
"0","p.adjust(m, method=""fdr"")"
"1","                 Diet "
"1","Geographical_location "
"1","               Gender "
"1","
"
"1","           0.40257244 "
"1","           0.06523656 "
"1","           0.95569587 "
"1","
"
"0","c <- ggplot(df, aes(x = Soap, y = shannon)) +    ## Shannon Diversity for location"
"0","geom_boxplot(outlier.shape = NA) + "
"0","  geom_jitter(width = 0.05) + "
"0","  labs(y= ""Shannon index"", x= """", title = ""C. Soap"") + theme_bw() + theme(text = element_text(size = 13), axis.text = element_text(size = 10), axis.title = element_text(size = 12)) #+ geom_signif(comparisons = list(c(""Ahmednagar"", ""Pune""), c(""Pune"",""Nashik""), c(""Nashik"", ""Ahmednagar"")), map_signif_level = FALSE, na.rm = TRUE)"
"0",""
"0","print(c)"
