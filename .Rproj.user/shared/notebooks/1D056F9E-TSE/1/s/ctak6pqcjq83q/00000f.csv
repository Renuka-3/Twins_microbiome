"0","library(readxl)    # To read Excel files"
"0","library(dplyr)"
"0","library(mia)"
"0","library(TreeSummarizedExperiment)"
"0",""
"0","# Read count data"
"0","counts  <- read_excel(""data/OTUtable.xlsx"") # Abundance table (e.g. ASV data; to assay data)"
"0","row.names(counts) <- counts$OTU "
"0","counts <- counts %>% select (-OTU)"
"0","counts <- as.matrix(counts) # Count data must be a matrix"
"0",""
"0","# Read taxonomic table"
"0","tax <- as.data.frame(read_excel(""data/Taxatable.xlsx""))   # Taxonomy table (to rowData)"
"0","row.names(tax) <- tax$OTU"
"0","tax <- tax %>% select (-OTU) "
"0",""
"0","# Read sample metadata"
"0","sampledata <- as.data.frame(read_excel(""data/Metadata.xlsx""))   # Sample data (to colData)"
"0","row.names(sampledata) <- sampledata$Sample"
"0",""
"0","# Convert data into TreeSummarizedExperiment object"
"0","twins_tse <- TreeSummarizedExperiment(assays = SimpleList(counts=counts),"
"0","                                     colData = sampledata,"
"0","                                     rowData = tax) "
"0",""
"0","# Save the data object"
"0","saveRDS(twins_tse, file=""data/twins_tse.rds"")"
